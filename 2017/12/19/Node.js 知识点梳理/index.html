<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Node.js,Node.js 知识点梳理," />










<meta name="description" content="概念和原理 Node.js 是基于chrome v8 引擎运行在服务器端的运行时（可理解为类似java的jre）">
<meta name="keywords" content="Node.js,Node.js 知识点梳理">
<meta property="og:type" content="article">
<meta property="og:title" content="Node.js 知识点梳理">
<meta property="og:url" content="http://jhgrrewq.github.io/2017/12/19/Node.js 知识点梳理/index.html">
<meta property="og:site_name" content="jhgrrewq 前端小站">
<meta property="og:description" content="概念和原理 Node.js 是基于chrome v8 引擎运行在服务器端的运行时（可理解为类似java的jre）">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ony85apla.bkt.clouddn.com/18-2-10/7115488.jpg">
<meta property="og:image" content="http://ony85apla.bkt.clouddn.com/18-2-10/12888853.jpg">
<meta property="og:image" content="http://ony85apla.bkt.clouddn.com/18-2-10/57943648.jpg">
<meta property="og:image" content="http://ony85apla.bkt.clouddn.com/18-6-23/96846634.jpg">
<meta property="og:updated_time" content="2018-06-25T05:56:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Node.js 知识点梳理">
<meta name="twitter:description" content="概念和原理 Node.js 是基于chrome v8 引擎运行在服务器端的运行时（可理解为类似java的jre）">
<meta name="twitter:image" content="http://ony85apla.bkt.clouddn.com/18-2-10/7115488.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'O0AP0FGXSX',
      apiKey: 'ab7c2224e88a925feeea82c8902add9d',
      indexName: 'jhgrrewq',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jhgrrewq.github.io/2017/12/19/Node.js 知识点梳理/"/>





  <title>Node.js 知识点梳理 | jhgrrewq 前端小站</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jhgrrewq 前端小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">置我于死地者 必将赐我以后生</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jhgrrewq.github.io/2017/12/19/Node.js 知识点梳理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jhgrrewq">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/8380737?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jhgrrewq 前端小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Node.js 知识点梳理</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-19T10:20:52+08:00">
                2017-12-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <!-- markdownlint-disable MD010 -->
<h2 id="概念和原理"><a href="#概念和原理" class="headerlink" title="概念和原理"></a>概念和原理</h2><blockquote>
<p><strong>Node.js 是基于chrome v8 引擎运行在服务器端的运行时（可理解为类似java的jre）</strong></p>
</blockquote>
<a id="more"></a>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><h4 id="单线程"><a href="#单线程" class="headerlink" title="单线程"></a>单线程</h4><p>java、php或者.net等服务器端语言，会为每个客户端连接创建一个线程，而每个线程约要耗费2M内存。因此为了让web程序支持更多用户，就需要增加服务器的数量，进而可能需要提升服务器的性能（单核变多核），这无疑提升了服务器的硬件成本。</p>
<p><strong>Node.js只使用单线程，不会为每个客户端连接创建一个新线程。</strong>当有客户端连接，就触发一个内部事件，通过<strong>非阻塞I/O、事件驱动机制</strong>，让Node.js宏观上并行，实现高并发。</p>
<p>单线程的优点：操作系统没有线程创建、销毁的开销；缺点：某个客户端造成线程崩溃，整个服务就崩溃，其他客户端也崩溃。</p>
<p><img src="http://ony85apla.bkt.clouddn.com/18-2-10/7115488.jpg" alt=""></p>
<h4 id="非阻塞-I-O"><a href="#非阻塞-I-O" class="headerlink" title="非阻塞 I/O"></a>非阻塞 I/O</h4><p>I/O比cpu运算要耗费更长的时间。传统的单线程机制中，I/O执行时，整个线程会暂停等待I/O完成返回结果后，才执行下面的代码，也就是说<strong>I/O阻塞了代码的执行</strong>。</p>
<p><strong>Node.js采用非阻塞I/O, 遇到I/O读写代码时，立即转而执行其后面的代码，将I/O返回的结果放在回调函数中</strong>，提高了代码的执行效率。<strong>当某个I/O执行完毕，将以事件形式通知执行I/O操作的线程，线程执行该I/O的回调。</strong> 为了处理异步I/O, 线程必须有事件循环机制，不断检查是否有未经处理的事件，依次处理。</p>
<p><img src="http://ony85apla.bkt.clouddn.com/18-2-10/12888853.jpg" alt=""></p>
<h4 id="事件驱动"><a href="#事件驱动" class="headerlink" title="事件驱动"></a>事件驱动</h4><p>在Node中，客户端请求建立连接，提交数据等行为，会触发相应事件。<strong>在Node中，在一个时刻，只能处理一个事件回调， 但在处理一个事件回调的过程中，可以转而处理其他事件（比如有新的客户端连接），然后返回继续执行原事件的回调。这是Node的”事件环”机制</strong>。不管是新的客户端的连接请求，还是老的客户端的I/O执行完成，都会通过事件方式加入事件环，等待调度（通过一定的优先级算法调度）。</p>
<p><img src="http://ony85apla.bkt.clouddn.com/18-2-10/57943648.jpg" alt=""></p>
<blockquote>
<p>三者缺一不可：</p>
<ul>
<li>单线程为了防止线程被I/O阻塞，引入非阻塞I/O; </li>
<li>非阻塞I/O不会等待I/O语句结束，而是先执行下面代码，但是I/O异步执行结束后需要某种机制通知线程，引入事件驱动；</li>
<li>触发的操作以事件形式加入事件环，等待调度</li>
</ul>
</blockquote>
<h3 id="适合开发"><a href="#适合开发" class="headerlink" title="适合开发"></a>适合开发</h3><ul>
<li>I/O密集，而非cpu密集 （cpu密集同样会阻塞线程）</li>
<li>和 web socket 配合开发长连接实时交互应用</li>
</ul>
<h2 id="Node-js-内置模块"><a href="#Node-js-内置模块" class="headerlink" title="Node.js 内置模块"></a>Node.js 内置模块</h2><h3 id="fs"><a href="#fs" class="headerlink" title="fs"></a>fs</h3><p>Node.js fs 模块中的方法均有同步和异步版本，异步方法最后一个函数为回调函数，回调函数的第一个参数包含了错误信息</p>
<p><strong>关于文件读取，服务器启动如果是要读取配置文件或者结束时写入状态文件，可以使用同步代码，因为这些代码只是在启动或者结束时执行一次，其余时候尽量使用异步代码，因为 js 单线程的特点，同步代码极容器带来阻塞</strong></p>
<h4 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h4><ul>
<li><strong><code>fs.readFile(path, [type], callback)</code> 异步读取文件</strong></li>
</ul>
<p><strong>读取二进制文件，不传入文件编码时，回调拿到的数据是一个 Buffer 对象</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> result = fs.readFile(<span class="string">'./example.txt'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">// console.log(data) // 输出二进制buffer</span></span><br><span class="line">		<span class="comment">// Buffer 对象转化 String 调用 toString() 方法</span></span><br><span class="line">		<span class="built_in">console</span>.log(data.toString())</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result2 = fs.readFile(<span class="string">'./example.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.readFileSync(path, [type])</code> 同步读取文件（没有回调）</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	<span class="keyword">let</span> data = fs.readFileSync(<span class="string">'./example.txt'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h4><ul>
<li><strong><code>fs.writeFile(path, data, [type], callback)</code> 异步写文件</strong></li>
</ul>
<p><strong>如果传入数据是 String 类型，默认 utf-8 编码写入文件；如果传入 Buffer，则写入二进制文件；回调函数只关系成功与否，只需要一个 err 参数</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果文件不存在，则创建文件，否则覆盖其内容</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">var</span> data = <span class="string">'abc'</span></span><br><span class="line">fs.writeFile(<span class="string">'./example.txt'</span>, data, (err) =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'ok'</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.writeFileSync(path, data, [type])</code> 同步写文件</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	fs.writeFileSync(<span class="string">'./example.txt'</span>, <span class="string">'hello'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'ok'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="文件流读取文件"><a href="#文件流读取文件" class="headerlink" title="文件流读取文件"></a>文件流读取文件</h4><p>流是一种抽象的数据结构，可以将数据看成数据流。标准输入流：字符从键盘输入到应用程序；标准输出流：字符从应用程序输出到显示器</p>
<p>从文件中读取数据时，可以打开一个文件流，从文件流中读取；向文件中写数据时，只需要向文件流中不断写入数据</p>
<p><strong>一般文件操作都是将文件整个放入内存，流相当于一点一点读写</strong></p>
<p>Node.js 中流是一个对象，只需要关注响应流的事件即可：<strong><code>data</code> 事件表示流已经可以读取（<code>data</code> 事件可能有多次，每次的 <code>chunk</code> 是流的一部分数据），<code>end</code> 事件表示该流已经到末尾，已经没有数据可以读取，<code>error</code> 事件表示出错, <code>close</code> 事件表示不会再有事件抛出</strong></p>
<ul>
<li><strong><code>fs.createReadStream(path, [type])</code> 创建读流，从某个文件以某种编码读取</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> rs = fs.createReadStream(<span class="string">'./example.txt'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line"><span class="comment">// 等同于 const rs = fs.createReadStream('./example.txt'); rs.setEncoding('UTF8')</span></span><br><span class="line"><span class="comment">// rs.pipe(process.stdout) // process.stdout 标准输出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理事件 data error end close</span></span><br><span class="line">rs.on(<span class="string">'data'</span>, (chunk) =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'读取数据：'</span> + chunk) <span class="comment">// data 事件表示流可以读取，可能会有多次，每次 chunk 是流的一部分数据</span></span><br><span class="line">&#125;).on(<span class="string">'err'</span>, (err) =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'错误：'</span> + error)</span><br><span class="line">&#125;).on(<span class="string">'end'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'没有数据'</span>) <span class="comment">// end 事件表示已经到流末尾，没有数据</span></span><br><span class="line">&#125;).on(<span class="string">'close'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'已经关闭'</span>) <span class="comment">// close 事件表示已经关闭，没有事件抛出</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="文件流写入文件"><a href="#文件流写入文件" class="headerlink" title="文件流写入文件"></a>文件流写入文件</h4><ul>
<li><strong><code>fs.createWriteStream(path, [type])</code> 创建写流，不断调用 write() 方法，最后 end() 结束</strong></li>
<li><strong><code>stream.write(data)</code> data 为 String 类型 或 Buffer</strong></li>
<li><strong><code>stream.end()</code> 关闭流，会触发 finish 事件</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">let</span> data = <span class="string">'abc'</span></span><br><span class="line"><span class="keyword">const</span> ws = fs.createWriteStream(<span class="string">'./example.txt'</span>)</span><br><span class="line">ws.write(data, <span class="string">'utf-8'</span>) <span class="comment">// data 可为 String 类型或 Buffer</span></span><br><span class="line">ws.end() <span class="comment">// 关闭流会触发 finish 事件</span></span><br><span class="line">ws.on(<span class="string">'finish'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'写入完成'</span>)</span><br><span class="line">&#125;).on(<span class="string">'error'</span>, (err) =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h4><ul>
<li><strong><code>fs.unlink(path, cb)</code> 异步删除文件</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.unlink(<span class="string">'./example.txt'</span>, (err) =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'删除文件成功'</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.unlinkSync(path)</code> 同步删除文件</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	fs.unlinkSync(<span class="string">'./example.txt'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="文件是否存在"><a href="#文件是否存在" class="headerlink" title="文件是否存在"></a>文件是否存在</h4><ul>
<li><strong><code>fs.access(path, cb)</code> 除了判断文件是否存在，还判断文件权限</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.access(<span class="string">'./example.txt'</span>, (err) =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'example.txt 存在'</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="文件重命名"><a href="#文件重命名" class="headerlink" title="文件重命名"></a>文件重命名</h4><ul>
<li><strong><code>fs.rename(oldPath, newPath, cb)</code> 异步文件重命名</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.rename(<span class="string">'./example.txt'</span>, <span class="string">'./example2.txt'</span>, err =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'重命名成功'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.renameSync(oldPath, newPath)</code> 同步文件重命名</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	fs.renameSync(<span class="string">'./example.txt'</span>, <span class="string">'./example2.txt'</span>)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'重命名成功'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h4><ul>
<li><strong><code>fs.mkdir(path, [mode], cb)</code> 异步创建目录，如果目录已经存在会报错, mode 设置目录权限</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.mkdir(<span class="string">'./hello'</span>, (err) =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'目录创建成功'</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.mkdirSync(path)</code> 同步创建目录</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	fs.mkdirSync(<span class="string">'./hello'</span>)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'目录创建成功'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="读取目录"><a href="#读取目录" class="headerlink" title="读取目录"></a>读取目录</h4><ul>
<li><strong><code>fs.readdir(path, [options], cb)</code> 异步读取目录</strong></li>
</ul>
<p>回调 <code>cb</code> 有两个参数 <code>err</code> <code>files</code>， <code>files</code> 为目录下的文件数组列表</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.readdir(<span class="string">'./'</span>, (err, files) =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125;</span><br><span class="line">	files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(file)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.readdirSync(path, [options])</code> 同步读取目录</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> files = fs.readdirSync(<span class="string">'./'</span>)</span><br><span class="line">	files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(file)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="监听文件修改"><a href="#监听文件修改" class="headerlink" title="监听文件修改"></a>监听文件修改</h4><ul>
<li><strong><code>fs.watchFile(path, [options], [cb])</code></strong></li>
</ul>
<p><strong>实现原理：轮询。每隔一段时间检查文件是否变化。在不同平台上的表现基本一致</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.watchFile(<span class="string">'./example.txt'</span>, &#123;</span><br><span class="line">	interval: <span class="number">2000</span> <span class="comment">// 多久检查一次</span></span><br><span class="line">&#125;, (curr, prev) =&gt; &#123;</span><br><span class="line">	<span class="comment">// curr, prev 是被监听文件的状态</span></span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'修改时间为：'</span> + curr.mtime)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.watch(path, [options], [cb])</code></strong></li>
</ul>
<h4 id="修改文件权限"><a href="#修改文件权限" class="headerlink" title="修改文件权限"></a>修改文件权限</h4><ul>
<li><strong><code>fs.chmod(path, mode, cb)</code> 异步修改文件权限</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.chmod(<span class="string">'./example.txt'</span>, <span class="string">'777'</span>, (err) =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'权限修改成功'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.chmodSync(path, mode)</code> 同步修改文件权限</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	fs.chmodSync(<span class="string">'./example.txt'</span>, <span class="string">'777'</span>)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'权限修改成功'</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取文件状态"><a href="#获取文件状态" class="headerlink" title="获取文件状态"></a>获取文件状态</h4><ul>
<li><strong><code>fs.stat(path, cb)</code> 异步获取文件状态</strong></li>
</ul>
<p>回调 <code>cb</code> 接受 2 个参数 <code>err</code> <code>stats</code>：<code>stats</code> 是一个 <code>Class: fs.Stats</code> 的对象实例，有很多方法和属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  dev: <span class="number">2114</span>,</span><br><span class="line">  ino: <span class="number">48064969</span>,</span><br><span class="line">  mode: <span class="number">33188</span>,</span><br><span class="line">  nlink: <span class="number">1</span>,</span><br><span class="line">  uid: <span class="number">85</span>,</span><br><span class="line">  gid: <span class="number">100</span>,</span><br><span class="line">  rdev: <span class="number">0</span>,</span><br><span class="line">  size: <span class="number">527</span>,</span><br><span class="line">  blksize: <span class="number">4096</span>,</span><br><span class="line">  blocks: <span class="number">8</span>,</span><br><span class="line">  atime: Mon, <span class="number">10</span> Oct <span class="number">2011</span> <span class="number">23</span>:<span class="number">24</span>:<span class="number">11</span> GMT, <span class="comment">// 访问时间</span></span><br><span class="line">  mtime: Mon, <span class="number">10</span> Oct <span class="number">2011</span> <span class="number">23</span>:<span class="number">24</span>:<span class="number">11</span> GMT,  <span class="comment">// 文件内容修改时间</span></span><br><span class="line">  ctime: Mon, <span class="number">10</span> Oct <span class="number">2011</span> <span class="number">23</span>:<span class="number">24</span>:<span class="number">11</span> GMT,  <span class="comment">// 文件状态修改时间</span></span><br><span class="line">  birthtime: Mon, <span class="number">10</span> Oct <span class="number">2011</span> <span class="number">23</span>:<span class="number">24</span>:<span class="number">11</span> GMT  <span class="comment">// 创建时间</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如</p>
<ul>
<li><strong><code>stats.isFile()</code></strong> 是否是文件</li>
<li><strong><code>stats.isDirectory()</code></strong> 是否是目录</li>
<li><strong><code>stats.atime</code></strong> 访问时间（access time）</li>
<li><strong><code>stats.mtime</code></strong> 文件内容修改时间（modified time）</li>
<li><strong><code>stats.ctime</code></strong> 文件状态修改时间，比如修改文件所有者、修改权限、重命名等</li>
<li><strong><code>stats.birthtime</code></strong> 创建时间，但是在某些系统上拿不到</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> files = fs.readdirSync(<span class="string">'./'</span>)</span><br><span class="line">	files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">		fs.stat(file, (err, stats) =&gt; &#123;</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'文件名：'</span>, file)</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'文件大小：'</span>, stats.size)</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'创建时间：'</span>, stats.birthtime)</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'是否是目录：'</span>, stats.isDirectory())</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'是否是文件：'</span>, stats.isFile())</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>fs.stat(path)</code> 同步获取文件状态</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> files = fs.readdirSync(<span class="string">'./'</span>)</span><br><span class="line">	files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> stats = fs.statSync(file)</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'文件名：'</span>, file)</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'文件大小：'</span>, stats.size)</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'创建时间：'</span>, stats.birthtime)</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'是否是目录：'</span>, stats.isDirectory())</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'是否是文件：'</span>, stats.isFile())</span><br><span class="line">	&#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="url-模块"><a href="#url-模块" class="headerlink" title="url 模块"></a>url 模块</h3><p><img src="http://ony85apla.bkt.clouddn.com/18-6-23/96846634.jpg" alt=""></p>
<h4 id="url-解析"><a href="#url-解析" class="headerlink" title="url 解析"></a>url 解析</h4><ul>
<li><strong><code>url.parse(urlString, [parseQueryString], [slashesDenoteHos])</code> 将 url 字符串解析成 object</strong></li>
</ul>
<p>参数 <code>parseQueryString</code>（默认为 false）：如为 false，则 query 为未解析的字符串，对应值不会 decode；否则 query 为 object，并且其值会被 decode</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; parse &#125; = <span class="built_in">require</span>(<span class="string">'url'</span>)</span><br><span class="line"><span class="keyword">const</span> str = <span class="string">'http://Chyingp:HelloWorld@ke.qq.com:8080/index.html?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1#part=1'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(parse(str)) <span class="comment">// query 不解析</span></span><br><span class="line"><span class="built_in">console</span>.log(parse(str, <span class="literal">true</span>)) <span class="comment">// query 会被解析</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Url &#123;</span></span><br><span class="line"><span class="comment">  protocol: 'http:',</span></span><br><span class="line"><span class="comment">  slashes: true,</span></span><br><span class="line"><span class="comment">  auth: 'Chyingp:HelloWorld',</span></span><br><span class="line"><span class="comment">  host: 'ke.qq.com:8080',</span></span><br><span class="line"><span class="comment">  port: '8080',</span></span><br><span class="line"><span class="comment">  hostname: 'ke.qq.com',</span></span><br><span class="line"><span class="comment">  hash: '#part=1',</span></span><br><span class="line"><span class="comment">  search: '?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1',</span></span><br><span class="line"><span class="comment">  query: 'nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1',</span></span><br><span class="line"><span class="comment">  pathname: '/index.html',</span></span><br><span class="line"><span class="comment">  path: '/index.html?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1',</span></span><br><span class="line"><span class="comment">  href: 'http://Chyingp:HelloWorld@ke.qq.com:8080/index.html?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1#part=1' &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Url &#123;</span></span><br><span class="line"><span class="comment">  protocol: 'http:',</span></span><br><span class="line"><span class="comment">  slashes: true,</span></span><br><span class="line"><span class="comment">  auth: 'Chyingp:HelloWorld',</span></span><br><span class="line"><span class="comment">  host: 'ke.qq.com:8080',</span></span><br><span class="line"><span class="comment">  port: '8080',</span></span><br><span class="line"><span class="comment">  hostname: 'ke.qq.com',</span></span><br><span class="line"><span class="comment">  hash: '#part=1',</span></span><br><span class="line"><span class="comment">  search: '?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1',</span></span><br><span class="line"><span class="comment">  query: &#123; nick: '程序猿小卡' &#125;,</span></span><br><span class="line"><span class="comment">  pathname: '/index.html',</span></span><br><span class="line"><span class="comment">  path: '/index.html?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1',</span></span><br><span class="line"><span class="comment">  href: 'http://Chyingp:HelloWorld@ke.qq.com:8080/index.html?nick=%E7%A8%8B%E5%BA%8F%E7%8C%BF%E5%B0%8F%E5%8D%A1#part=1' &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h4 id="urlObject"><a href="#urlObject" class="headerlink" title="urlObject"></a>urlObject</h4><ul>
<li><code>protocol</code> 协议，包含了 ：，并且是小写</li>
<li><code>slashes</code> 如果 ：后面跟着 //，则为 true</li>
<li><code>auth</code> 认证信息，如果有密码，为 username:possword, 如果没有则为 username。区分大小写</li>
<li><code>host</code> 主机，包含了端口号，小写</li>
<li><code>hostname</code> 主机名，不含端口号，小写</li>
<li><code>port</code> 端口号</li>
<li><code>path</code> 路径部分，包含 search 部分</li>
<li><code>pathname</code> 路径部分，不包含 search 部分</li>
<li><code>search</code> 查询字符串，包含 ？，并且值没有 decode</li>
<li><code>query</code> 字符串或者对象，如果是字符串则是 search 去掉 ？；如果是对象则是 decode 过的</li>
<li><code>hash</code> 哈希部分，包含 #</li>
<li><code>href</code> 原始地址</li>
</ul>
<h3 id="events-模块"><a href="#events-模块" class="headerlink" title="events 模块"></a>events 模块</h3><p><strong>所有能触发事件的对象都是 EventEmitter 实例（需要继承 EventEmitter）</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>eventEmitter.on(event, fn)</code> 用于注册监听器，同一个事件可注册多个，当事件触发，事件监听器按照注册的顺序执行</strong></li>
<li><strong><code>eventEmitter.emit(event, arg1, ..., argN)</code> 用于触发事件</strong></li>
<li><strong><code>eventEmitter.once(event, fn)</code> 注册监听器，响应函数只执行一次</strong></li>
<li><strong><code>eventEmitter.removeListener(event, fn)</code> 移除某个事件的某个监听器</strong></li>
<li><strong><code>eventEmitter.removeAllListener(event)</code> 移除某个事件的全部监听器</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> ce = <span class="keyword">new</span> CustomEvent()</span><br><span class="line"></span><br><span class="line">ce.on(<span class="string">'error'</span>, (err, time) =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(err, time)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ce.emit(<span class="string">'error'</span>, <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'wrong'</span>), <span class="built_in">Date</span>.now())</span><br><span class="line"></span><br><span class="line">ce.once(<span class="string">'test'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'test'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	ce.emit(<span class="string">'test'</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'f1'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'f2'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ce.on(<span class="string">'remove'</span>, f1)</span><br><span class="line">ce.on(<span class="string">'remove'</span>, f2)</span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	ce.emit(<span class="string">'remove'</span>)</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	ce.removeListener(<span class="string">'remove'</span>, f2)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<h3 id="path-模块"><a href="#path-模块" class="headerlink" title="path 模块"></a>path 模块</h3><p>path 模块会根据 Node.js 程序运行的操作系统使用对应操作系统风格的路径。想要任何操作系统处理 window 文件路径获得一致结果，使用<code>path.win32</code>; 想要任何操作系统处理 POSIX 文件路径获得一致结果,使用 <code>path.posix</code>; 如果 <code>path.win32.basename()</code></p>
<h4 id="获取路径-文件名-扩展名"><a href="#获取路径-文件名-扩展名" class="headerlink" title="获取路径/文件名/扩展名"></a>获取路径/文件名/扩展名</h4><ul>
<li><strong><code>path.dirname(filePath)</code> 获取所在文件夹路径</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; dirname &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> filePath = <span class="string">'/usr/local/bin/no.txt'</span></span><br><span class="line"><span class="built_in">console</span>.log(dirname(filePath)) <span class="comment">// /usr/local/bin</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>path.basename(filename)</code> 获取文件名，严格意义上只是获取路径的最后一部分，并不会判断是否是文件名</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; basename &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> filePath1 = <span class="string">'/usr/local/bin/no.txt'</span></span><br><span class="line"><span class="keyword">const</span> filePath2 = <span class="string">'/usr/local/bin'</span></span><br><span class="line"><span class="comment">// 返回路径的最后一部分</span></span><br><span class="line"><span class="built_in">console</span>.log(basename(filePath1)) <span class="comment">// no.txt</span></span><br><span class="line"><span class="built_in">console</span>.log(basename(filePath2)) <span class="comment">// bin</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>path.extname(filePath)</code> 获取扩展名，严格意义上只是从最后一个 <code>.</code> 开始截取到最后一个字符；没有 <code>.</code> 或者第一个字符是 <code>.</code>,直接返回空字符</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; extname &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> filePath = <span class="string">'/usr/local/bin/no.txt'</span></span><br><span class="line"><span class="keyword">const</span> filePath2 = <span class="string">'/usr/local/bin'</span></span><br><span class="line"><span class="keyword">const</span> filePath3 = <span class="string">'/usr/local/bin/no.min.txt'</span></span><br><span class="line"><span class="keyword">const</span> filePath4 = <span class="string">'/usr/local/bin.'</span></span><br><span class="line"><span class="keyword">const</span> filePath5 = <span class="string">'./usr/local/bin'</span></span><br><span class="line"><span class="built_in">console</span>.log(extname(filePath)) <span class="comment">// .txt</span></span><br><span class="line"><span class="built_in">console</span>.log(extname(filePath2)) <span class="comment">//</span></span><br><span class="line"><span class="built_in">console</span>.log(extname(filePath3)) <span class="comment">// .txt</span></span><br><span class="line"><span class="built_in">console</span>.log(extname(filePath4)) <span class="comment">// .</span></span><br><span class="line"><span class="built_in">console</span>.log(extname(filePath5)) <span class="comment">//</span></span><br></pre></td></tr></table></figure>
<h4 id="格式化路径字符串"><a href="#格式化路径字符串" class="headerlink" title="格式化路径字符串"></a>格式化路径字符串</h4><ul>
<li><strong><code>path.normalize(filePath)</code></strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; normalize &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(normalize(<span class="string">'/usr//local/node'</span>)) <span class="comment">// /usr/local/node</span></span><br><span class="line"><span class="built_in">console</span>.log(normalize(<span class="string">'/usr//local/../node'</span>)) <span class="comment">// /usr/node</span></span><br></pre></td></tr></table></figure>
<h4 id="路径组合"><a href="#路径组合" class="headerlink" title="路径组合"></a>路径组合</h4><ul>
<li><strong><code>path.join([...paths])</code> 将 paths 拼接后再调用 normalize</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; join &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(join(<span class="string">'/usr'</span>, <span class="string">'local'</span>, <span class="string">'/node/'</span>)) <span class="comment">// /usr/local/node/</span></span><br><span class="line"><span class="built_in">console</span>.log(join(<span class="string">'/usr'</span>, <span class="string">'../local'</span>, <span class="string">'/node/'</span>)) <span class="comment">// /local/node/</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>path.resolve([...paths])</code> 将相对路径解析为绝对路径</strong></li>
</ul>
<p>相当于不断调用系统的 <code>cd</code> 命令</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>) <span class="comment">// /Users/jackzhang/workspace/code/Node/nodejs/Node</span></span><br><span class="line"><span class="built_in">console</span>.log(resolve(<span class="string">'./'</span>))</span><br></pre></td></tr></table></figure>
<h4 id="路径解析"><a href="#路径解析" class="headerlink" title="路径解析"></a>路径解析</h4><ul>
<li><strong><code>path.parse(path)</code> 将文件名解析包含 root，dir，ext，name, base 属性的对象</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; parse &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> filePath = <span class="string">'/usr/local/bin/no.txt'</span></span><br><span class="line"><span class="built_in">console</span>.log(parse(filePath))</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#123; root: '/',</span></span><br><span class="line"><span class="comment">  dir: '/usr/local/bin',</span></span><br><span class="line"><span class="comment">  base: 'no.txt',</span></span><br><span class="line"><span class="comment">  ext: '.txt',</span></span><br><span class="line"><span class="comment">  name: 'no' &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>path.format(obj)</code> 和 parse 相反，一般用于修改文件名的一些属性生成路径</strong></li>
</ul>
<p>优先级 <code>dir</code> 比 <code>root</code> 高， <code>base</code> 比 <code>name</code> 和 <code>ext</code> 高</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; format &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">let</span> data1 = &#123;</span><br><span class="line">	root: <span class="string">'/'</span>,</span><br><span class="line">  dir: <span class="string">'/usr/local/bin'</span>,</span><br><span class="line">  ext: <span class="string">'.txt'</span>,</span><br><span class="line">  name: <span class="string">'no'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(format(data1))  <span class="comment">// /usr/local/bin/no.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data2 = &#123;</span><br><span class="line">	root: <span class="string">'/'</span>,</span><br><span class="line">  dir: <span class="string">'/usr/local/bin'</span>,</span><br><span class="line">  base: <span class="string">'no1.txt'</span>,</span><br><span class="line">  ext: <span class="string">'.txt'</span>,</span><br><span class="line">  name: <span class="string">'no'</span> &#125;</span><br><span class="line"><span class="built_in">console</span>.log(format(data2)) <span class="comment">// /usr/local/bin/no1.txt</span></span><br></pre></td></tr></table></figure>
<h4 id="获取相对路径"><a href="#获取相对路径" class="headerlink" title="获取相对路径"></a>获取相对路径</h4><ul>
<li><strong><code>path.relative(from, to)</code> 返回从 from 进入 to 的相对路径</strong></li>
</ul>
<p>如果 <code>from</code> <code>to</code> 指向同一个路径，返回空字符串；如果两者任一为空，返回当前工作路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; relative &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line">relative(<span class="string">'/data/orandea/test/aaa'</span>, <span class="string">'/data/orandea/impl/bbb'</span>) <span class="comment">// ../../impl/bbb</span></span><br><span class="line"><span class="built_in">console</span>.log(relative(<span class="string">'/data/demo'</span>, <span class="string">'/data/demo'</span>)) <span class="comment">// ''</span></span><br></pre></td></tr></table></figure>
<h4 id="平台相关"><a href="#平台相关" class="headerlink" title="平台相关"></a>平台相关</h4><ul>
<li><strong><code>path.posix</code> 平台 linux 下实现的 path 相关属性方法</strong></li>
<li><strong><code>path.win32</code> 平台 win32 下实现的 path 相关属性方法</strong></li>
<li><strong><code>path.sep</code> 路径分割符，linux 上是 <code>/</code> windows 上是 <code>\</code></strong></li>
<li><strong><code>path.delimiter</code>  path 设置的分割符，linux 上是 <code>:</code> windows 上是 <code>;</code></strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'sep:'</span>, sep)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'win sep:'</span>, win32.sep)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'posix sep:'</span>, posix.sep)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'delimiter'</span>, delimiter)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'win delimiter'</span>, win32.delimiter)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'posix delimiter'</span>, posix.delimiter)</span><br><span class="line">cnosole.log(win32.join(<span class="string">'/tmp'</span>, <span class="string">'demo'</span>))</span><br><span class="line"><span class="comment">// sep: /</span></span><br><span class="line"><span class="comment">// win sep: \</span></span><br><span class="line"><span class="comment">// posix sep: /</span></span><br><span class="line"><span class="comment">// delimiter :</span></span><br><span class="line"><span class="comment">// win delimiter ;</span></span><br><span class="line"><span class="comment">// posix delimiter :</span></span><br><span class="line"><span class="comment">// \\tmp\\demo</span></span><br></pre></td></tr></table></figure>
<h4 id="util-模块"><a href="#util-模块" class="headerlink" title="util 模块"></a>util 模块</h4><p><code>util</code> 模块提供了常用的函数合集</p>
<ul>
<li><strong><code>util.inherits(constructor, superConstructor)</code> 实现对象的原型继承</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>)</span><br><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomEvent</span> </span>&#123;&#125;</span><br><span class="line">util.inherits(CustomEvent, EventEmitter)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>util.promisify(fn)</code> 将方法 promisify</strong></li>
</ul>
<p>promise 异步变同步书写，除了用一些第三方库 如 bluebird，还可以用 <code>util.promisify</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; readFile &#125; = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; promisify &#125; = <span class="built_in">require</span>(<span class="string">'util'</span>)</span><br><span class="line"><span class="keyword">const</span> read = promisify(readFile)</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="keyword">let</span> data = <span class="keyword">await</span> read(<span class="string">'./example.txt'</span>)</span><br><span class="line">		<span class="built_in">console</span>.log(data)</span><br><span class="line">	&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<h3 id="Buffer-模块"><a href="#Buffer-模块" class="headerlink" title="Buffer 模块"></a>Buffer 模块</h3><p>Buffer 模块用来处理二级制数据。Buffer 实例类似整数数组（0-255 的 16 进制数），<strong>大小是创建时候确定的，无法调整</strong></p>
<h4 id="Buffer-静态方法"><a href="#Buffer-静态方法" class="headerlink" title="Buffer 静态方法"></a>Buffer 静态方法</h4><ul>
<li><strong><code>Buffer.alloc()</code> <code>Buffer.from()</code> <code>Buffer.allocUnsafe()</code> 创建方法</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Buffer = <span class="built_in">require</span>(<span class="string">'Buffer'</span>)</span><br><span class="line"><span class="comment">// 创建一个长度为 5，用 0 填充的 Buffer</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.allo(<span class="number">5</span>)) <span class="comment">// &lt;Buffer 00 00 00 00 00&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个长度为 5，用 0x1 填充的 Buffer</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.allo(<span class="number">5</span>, <span class="number">1</span>)) <span class="comment">// &lt;Buffer 01 01 01 01 01&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个长度为 5，但没有初始化的 Buffer 实例</span></span><br><span class="line"><span class="comment">// 该方法比 Buffer.allo() 调用快，但是可能会包含有旧数据，需要调用 fill() 或者 write() 方法 重写</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.alloUnsafe(<span class="number">5</span>)) <span class="comment">// &lt;Buffer ef 2e 3b 0c 00&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Buffer.from(array) // 返回一个当前数组副本的 Buffer</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])) <span class="comment">// &lt;Buffer 01 02 03&gt;</span></span><br><span class="line"><span class="comment">// Buffer.from(string, [encoding]) // 返回一个字符串的 Buffer，第二个参数可以指定编码</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.from(<span class="string">'test'</span>)) <span class="comment">// &lt;Buffer 74 65 73 74&gt;</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.from(<span class="string">'test'</span>,<span class="string">'base64'</span>)) <span class="comment">// &lt;Buffer b5 eb 2d&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>Buffer.byteLength()</code> 字符串实际占了几个字节</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Buffer = <span class="built_in">require</span>(<span class="string">'Buffer'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(Buffer.byteLength(<span class="string">'test'</span>)) <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.byteLength(<span class="string">'测试'</span>)) <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>Buffer.isBuffer()</code> 该对象是否是 Buffer 实例</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Buffer = <span class="built_in">require</span>(<span class="string">'Buffer'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(Buffer.isBuffer(&#123;&#125;)) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(Buffer.isBuffer(Buffer.from([<span class="number">1</span>]))) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>Buffer.concat()</code> 拼接 Buffer</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Buffer = <span class="built_in">require</span>(<span class="string">'Buffer'</span>)</span><br><span class="line"><span class="keyword">const</span> b0 = Buffer.from(<span class="string">'this'</span>)</span><br><span class="line"><span class="keyword">const</span> b1 = Buffer.from(<span class="string">' is'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(Buffer.concat([b0, b1]).toString()) <span class="comment">// this is</span></span><br></pre></td></tr></table></figure>
<h4 id="Buffer-实例方法"><a href="#Buffer-实例方法" class="headerlink" title="Buffer 实例方法"></a>Buffer 实例方法</h4><ul>
<li><strong><code>buf.length</code> Buffer 本身占得字节数，和申请创建的空间有关，和 Buffer 内容无关</strong></li>
<li><strong><code>buf.toString([, encoding])</code> 将二进制转化为指定编码字符串，默认转 utf8</strong></li>
<li><strong><code>buf.fill(value, start, end)</code> 填充，默认是用 0 填充，value 是 Number 或 String, start 为开始下标，end 为结束下标（不包括）</strong></li>
<li><strong><code>buf.equals()</code> 比较两个 bufer 内容是否相同</strong></li>
<li><strong><code>buf.indexOf()</code> 类似数组同名用法</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buf = Buffer.from(<span class="string">'this is test'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buf.length) <span class="comment">// 12</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buf2 = Buffer.alloc(<span class="number">10</span>)</span><br><span class="line">buf2[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(buf2.length) <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(buf.toString(<span class="string">'base64'</span>)) <span class="comment">// dGhpcyBpcyB0ZXN0</span></span><br><span class="line"><span class="built_in">console</span>.log(buf.toString()) <span class="comment">// this is text</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buf3 = Buffer.allocUnsafe(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buf3) <span class="comment">// &lt;Buffer ff ff ff ff ff ff ff ff 01 08&gt;</span></span><br><span class="line"><span class="built_in">console</span>.log(buf3.fill(<span class="number">10</span>, <span class="number">2</span>, <span class="number">6</span>)) <span class="comment">// &lt;Buffer ff ff 0a 0a 0a 0a ff ff 01 08&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buf4 = Buffer.from(<span class="string">'test'</span>)</span><br><span class="line"><span class="keyword">const</span> buf5 = Buffer.from(<span class="string">'test'</span>)</span><br><span class="line"><span class="keyword">const</span> buf6 = Buffer.from(<span class="string">'tes'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buf4.equals(buf5)) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(buf4.equals(buf6)) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(buf4.indexOf(<span class="string">'es'</span>)) <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(buf4.indexOf(<span class="string">'esa'</span>)) <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>
<h3 id="zlib-模块"><a href="#zlib-模块" class="headerlink" title="zlib 模块"></a>zlib 模块</h3><p>浏览器通过 http 请求头部添加 <code>Accept-Encoding: gzip, deflate</code> 告诉服务器可以使用 gzip 或 deflate 算法压缩资源，Node.js 中使用 zlib 模块对资源进行压缩</p>
<h4 id="压缩解压"><a href="#压缩解压" class="headerlink" title="压缩解压"></a>压缩解压</h4><ul>
<li><strong>zlib.createGzip() 压缩</strong></li>
<li><strong>zlib.createGunzip() 解压</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> zlib = <span class="built_in">require</span>(<span class="string">'zlib'</span>)</span><br><span class="line"><span class="keyword">const</span> filePath = <span class="string">'./example.txt'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> acceptEncoding = req.headers[<span class="string">'accept-encoding'</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (acceptEncoding.indexOf(<span class="string">'gzip'</span>) &gt; <span class="number">-1</span>) &#123; <span class="comment">// 判断是否需要 gzip 压缩</span></span><br><span class="line">    <span class="comment">// 响应头部 Content-Encoding，告诉浏览器文件被 gzip 压缩过</span></span><br><span class="line">    res.writeHeader(<span class="number">200</span>, &#123;</span><br><span class="line">      <span class="string">'Content-Encoding'</span>: <span class="string">'gzip'</span></span><br><span class="line">    &#125;)</span><br><span class="line">    fs.createReadStream(filePath).pipe(zlib.createGzip()).pipe(res)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fs.createReadStream(filePath).pipe(res)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).listen(<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>
<h3 id="string-decoder-模块"><a href="#string-decoder-模块" class="headerlink" title="string_decoder 模块"></a>string_decoder 模块</h3><p>string_decoder 模块用于将 Buffer 转成对应的字符串。特殊之处在于，<strong>当传入的 buffer 不完整（如三个字节的字符，只传入了两个），内部会维护一个 internal buffer 将不完整的字节 cache，等到使用者再次调用 <code>stringDecoder.write(buffer)</code> 传入剩余字节时，来拼接成完整的字符</strong></p>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><ul>
<li><strong><code>decoder.write(buffer)</code> 调用传入 Buffer 对象，返回对应编码字符串</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; StringDecoder &#125; = <span class="built_in">require</span>(<span class="string">'string_decoder'</span>)</span><br><span class="line"><span class="keyword">const</span> decoder = <span class="keyword">new</span> StringDecoder(<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Buffer.from('你') =》 &lt;Buffer e4 bd a0&gt;</span></span><br><span class="line"><span class="built_in">console</span>.log(decoder.write(Buffer.from([<span class="number">0xe4</span>, <span class="number">0xbd</span>, <span class="number">0xa0</span>]))) <span class="comment">// 你</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>decoder.end([buffer])</code> 调用时会把内部剩余的 buffer 一次性返回, 相当于 decoder.write(buffer) decoder.end()</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> StringDecoder = <span class="built_in">require</span>(<span class="string">'string_decoder'</span>).StringDecoder;</span><br><span class="line"><span class="keyword">const</span> decoder = <span class="keyword">new</span> StringDecoder(<span class="string">'utf8'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Buffer.from('你好') =&gt; &lt;Buffer e4 bd a0 e5 a5 bd&gt;</span></span><br><span class="line"><span class="keyword">let</span> str = decoder.write(Buffer.from([<span class="number">0xe4</span>, <span class="number">0xbd</span>, <span class="number">0xa0</span>, <span class="number">0xe5</span>, <span class="number">0xa5</span>])); <span class="comment">// 好 还差一个字节，因此 decoder.write(xx) 返回 你</span></span><br><span class="line"><span class="built_in">console</span>.log(str);  <span class="comment">// 你</span></span><br><span class="line"></span><br><span class="line">str = decoder.end(Buffer.from([<span class="number">0xbd</span>]));</span><br><span class="line"><span class="built_in">console</span>.log(str);  <span class="comment">// 好</span></span><br></pre></td></tr></table></figure>
<h3 id="process-模块"><a href="#process-模块" class="headerlink" title="process 模块"></a>process 模块</h3><p>process 模块是 Node.js 的全局模块，可用来获得 node 进程相关的信息</p>
<h4 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h4><ul>
<li><strong><code>process.env</code> 环境变量</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'开发环境'</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'生产环境'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行命令 <code>NODE_ENV=development node env.js</code> 输出 <code>开发环境</code></p>
<h4 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h4><ul>
<li><strong><code>process.nextTick(fn)</code> 实现异步，fn 放在 node 事件循环的下一个 tick，比 setTimeout(fn, 0) 性能高</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'start'</span>)</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'timeout'</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line">process.nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'tick'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'end'</span>)</span><br><span class="line"><span class="comment">// start</span></span><br><span class="line"><span class="comment">// end</span></span><br><span class="line"><span class="comment">// tick</span></span><br><span class="line"><span class="comment">// timeout</span></span><br></pre></td></tr></table></figure>
<h4 id="获取命令行参数"><a href="#获取命令行参数" class="headerlink" title="获取命令行参数"></a>获取命令行参数</h4><ul>
<li><strong><code>process.argv</code> 获取命令行文件名后的参数，返回一个数组，第一个元素是 node 程序安装路径，第二个元素是可执行文件的绝对路径，第三个参数开始是命令行文件名后传入的参数</strong></li>
</ul>
<p>一般使用从 <code>process.argv[2]</code> 开始</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=dev node <span class="number">10</span>_argv.js --env production</span><br><span class="line"></span><br><span class="line"><span class="comment">// argv[0] /usr/local/bin/node</span></span><br><span class="line"><span class="comment">// argv[1] /Users/jackzhang/workspace/code/Node/nodejs/Node/10_argv.js</span></span><br><span class="line"><span class="comment">// argv[2] --env</span></span><br><span class="line"><span class="comment">// argv[3] production</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>process.execArgv</code> 获得命令行文件名前传入的参数</strong></li>
</ul>
<p><code>process.execPath</code> node 程序安装路径，也就是 <code>process.argv[0]</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=dev node <span class="number">10</span>_argv.js --env production</span><br><span class="line"></span><br><span class="line"><span class="comment">// execArgv []</span></span><br><span class="line"><span class="comment">// execPath /usr/local/bin/node</span></span><br></pre></td></tr></table></figure>
<h4 id="当前工作路径"><a href="#当前工作路径" class="headerlink" title="当前工作路径"></a>当前工作路径</h4><ul>
<li><strong><code>process.cwd()</code> 返回 node 命令所在文件夹</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _dirname _filename 总是返回文件所在文件夹、文件的绝对路径（不管 node 在哪里执行）</span></span><br><span class="line"><span class="comment">// process.cwd() 返回执行 node 命令所在文件夹</span></span><br><span class="line"><span class="comment">// ./ 在 require 方法中都是相对于当前文件所在文件夹，在其他地方相当于 process.cwd(), node 命令执行文件夹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// nodejs/Node/example.js</span></span><br><span class="line"><span class="comment">// 目前在 nodejs 目录，执行 node Node/example.js</span></span><br><span class="line"><span class="comment">// __dirname     /Users/jackzhang/workspace/code/Node/nodejs/Node</span></span><br><span class="line"><span class="comment">// process.cwd() /Users/jackzhang/workspace/code/Node/nodejs</span></span><br><span class="line"><span class="comment">// ./            /Users/jackzhang/workspace/code/Node/nodejs</span></span><br></pre></td></tr></table></figure>
<h3 id="child-process-模块"><a href="#child-process-模块" class="headerlink" title="child_process 模块"></a>child_process 模块</h3><p>严格意义上说 Node.js 并不是真正的单线程架构，自身还有一定的 I/O 线程存在，这些线程由底层 libuv 处理，对于 js 开发者是透明的，只有 C++ 扩展开发时才会关注到。 js 代码永远运行在 V8 引擎上，是单线程的。</p>
<p>对于单进程单线程对多核 CPU 使用不足的问题，需要启动多进程。理想状态下每个进程各自利用一个 CPU，以此实现多核 CPU 的利用</p>
<h3 id="异步创建子进程（每个方法都有对应同步版本）"><a href="#异步创建子进程（每个方法都有对应同步版本）" class="headerlink" title="异步创建子进程（每个方法都有对应同步版本）"></a>异步创建子进程（每个方法都有对应同步版本）</h3><ul>
<li><strong><code>spawn()</code> 启动一个子进程来执行命令</strong></li>
<li><strong><code>exec()</code> 启动一个子进程来执行命令, 和 spawn() 不同的是，它有一个回调函数通知子进程的状况</strong></li>
<li><strong><code>execFile()</code> 启动一个子进程来执行可执行文件</strong></li>
<li><strong><code>fork()</code> 和 spawn() 类似，不同点在创建的子进程只需要指定要执行的 js 文件模块</strong></li>
</ul>
<p><code>spawn()</code> 和 <code>exec()</code> <code>execFile()</code> 不同的是后两者创建时可以指定 timeout 超时时间，一旦创建的进程运行事件超过设定事件会被杀死</p>
<p><strong><code>exec()</code> <code>execFile()</code> <code>fork()</code> 底层都是通过 <code>spawn()</code> 实现</strong></p>
<table>
<thead>
<tr>
<th>类型</th>
<th>回调/异常</th>
<th>进程类型</th>
<th>执行类型</th>
<th>可设置超时</th>
</tr>
</thead>
<tbody>
<tr>
<td>spawn</td>
<td>无</td>
<td>任意</td>
<td>命令</td>
<td>否</td>
</tr>
<tr>
<td>fork</td>
<td>无</td>
<td>Node</td>
<td>js 文件</td>
<td>否</td>
</tr>
<tr>
<td>exec</td>
<td>有</td>
<td>任意</td>
<td>命令</td>
<td>是</td>
</tr>
<tr>
<td>execFile</td>
<td>有</td>
<td>任意</td>
<td>可执行文件</td>
<td>是</td>
</tr>
</tbody>
</table>
<h3 id="net-模块（TCP）"><a href="#net-模块（TCP）" class="headerlink" title="net 模块（TCP）"></a>net 模块（TCP）</h3><p>http 模块中， http.Server 继承了 net.Server, http 客户端和 http 服务器的通信依赖于 socket（net.Socket）</p>
<p>net 模块主要包含两部分：</p>
<ul>
<li><code>net.Server</code> tcp server，内部通过 socket 来实现和客户端的通信</li>
<li><code>net.Socket</code> tcp/本地 socket 的 node 版实现，它实现<strong>全双工</strong>的 stream 接口</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务端代码</span></span><br><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>)</span><br><span class="line"><span class="comment">// 创建一个 tcp 服务器</span></span><br><span class="line"><span class="keyword">var</span> server = net.createServer(<span class="function"><span class="params">socket</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// 回调中拿到新的连接</span></span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'服务器：收到来自客户端的请求'</span>)</span><br><span class="line"></span><br><span class="line">	socket.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'服务端：收到客户端的数据-'</span> + data)</span><br><span class="line">		<span class="comment">// 给客户端返回数据</span></span><br><span class="line">		socket.write(<span class="string">'你好，我是服务端'</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	socket.on(<span class="string">'close'</span>, () =&gt; &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'服务端：客户端断开连接'</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;).listen(<span class="number">8000</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'服务端：开始监听来自客户端的请求'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 客户端代码</span></span><br><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>)</span><br><span class="line"><span class="keyword">const</span> PORT = <span class="number">8000</span></span><br><span class="line"><span class="keyword">const</span> HOST = <span class="string">'127.0.0.1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 tcp socket 套接字</span></span><br><span class="line"><span class="comment">// net.createConnection 客户端创建一个新的 net.Socket</span></span><br><span class="line"><span class="keyword">var</span> client = net.createConnection(PORT, HOST)</span><br><span class="line"></span><br><span class="line">client.on(<span class="string">'connect'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'客户端：已经和服务端建立连接'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">client.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'客户端：收到服务端数据-'</span> + data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">client.on(<span class="string">'close'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'客户端：连接断开'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">client.on(<span class="string">'error'</span>, () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'客户端：客户端错误'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">client.end(<span class="string">'你好，我是客户端'</span>) <span class="comment">// socket.write() socket.end() 套接字读写</span></span><br></pre></td></tr></table></figure>
<h4 id="tcp-服务器事件"><a href="#tcp-服务器事件" class="headerlink" title="tcp 服务器事件"></a>tcp 服务器事件</h4><p>通过 <code>net.createServer()</code> 创建的服务器是一个 <code>EventEmitter</code> 实例，有如下自定义属性</p>
<ul>
<li><code>listening 事件</code> 一般通过调用 server.listen() 触发</li>
<li><code>connection 事件</code> 每个客户端套接字连接到服务端时触发，简洁写法是通过 net.createServer() 最后一个参数传递</li>
<li><code>close 事件</code> 当服务器关闭触发，在调用 server.close() 后，服务器将停止接受新的套接字连接，但是保持当前存在的连接，<strong>等待所有连接都断开，会触发该事件</strong></li>
<li><code>error 事件</code> 当服务器发生异常将会触发该事件</li>
</ul>
<h4 id="连接事件"><a href="#连接事件" class="headerlink" title="连接事件"></a>连接事件</h4><p>服务器可以和多个客户端保持连接，每个连接（套接字 socket）都是可读可写的 stream 对象。<strong>stream 对象可以用于服务器和客户端之间的通信，既可以通过 <code>data</code> 事件从一端读取另一端发来的数据，也可以通过 <code>write()</code> 方法从一端向另一端发送数据</strong></p>
<ul>
<li><code>data 事件</code> 当一端调用 write() 发送数据，另一端会触发该事件，事件传递的数据就是 write() 发送的数据</li>
<li><code>connect 事件</code> 该事件用于客户端，当套接字和服务端连接成功触发</li>
<li><code>close 事件</code> 当套接字完全关闭会触发（当只要一个套接字连接，调用 socket.end() 也会触发）</li>
<li><code>error 事件</code> 当异常发生会触发</li>
<li><code>timeout 事件</code> 当一段时间后连接不再活跃，该事件会被触发，通知用户当前该连接已经被闲置</li>
</ul>
<h3 id="dgram-模块（UDP）"><a href="#dgram-模块（UDP）" class="headerlink" title="dgram 模块（UDP）"></a>dgram 模块（UDP）</h3><p>dgram 模块是对 UDP socket 的一层封装</p>
<h3 id="http-模块"><a href="#http-模块" class="headerlink" title="http 模块"></a>http 模块</h3><p>HTTP 全称是超文本传输协议（Hyper Text Transfer Protocol），构建与 TCP 之上，属于应用层协议</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>)</span><br><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>)</span><br><span class="line">http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// 获取 get 请求参数</span></span><br><span class="line">	<span class="keyword">var</span> urlObj = url.parse(req.url)</span><br><span class="line">	<span class="keyword">if</span> (urlObj.query) &#123;</span><br><span class="line">		<span class="keyword">var</span> queryObj = querystring.parse(urlObj.query)</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(queryObj))</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 获取 post 请求参数</span></span><br><span class="line">	<span class="comment">// var body = ''</span></span><br><span class="line">	<span class="comment">// req.on('data', thunk =&gt; &#123;</span></span><br><span class="line">	<span class="comment">// 	body += thunk</span></span><br><span class="line">	<span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">	res.writeHeader(<span class="number">200</span>, &#123;</span><br><span class="line">		<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	res.end(<span class="string">'hello'</span>)</span><br><span class="line">&#125;).listen(<span class="number">1337</span>)</span><br></pre></td></tr></table></figure>
<p>启动上述服务器端代码后，使用 curl 进行一次报文获取，-v 选项可以显示这次网络通信的所有报文信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ curl -v http://127.0.0.1:1337</span><br><span class="line"></span><br><span class="line"><span class="comment"># tcp 三次握手</span></span><br><span class="line">* Rebuilt URL to: http://127.0.0.1:1337/</span><br><span class="line">*   Trying 127.0.0.1...</span><br><span class="line">* Connected to 127.0.0.1 (127.0.0.1) port 1337 (<span class="comment">#0)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端向服务器端发送请求报文</span></span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: 127.0.0.1:1337</span><br><span class="line">&gt; User-Agent: curl/7.49.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 服务器完成处理向客户端返回响应报文</span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Content-Type: text/plain</span><br><span class="line">&lt; Date: Mon, 25 Jun 2018 04:26:49 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Transfer-Encoding: chunked</span><br><span class="line">&lt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结束会话</span></span><br><span class="line">* Connection <span class="comment">#0 to host 127.0.0.1 left intact</span></span><br></pre></td></tr></table></figure>
<h4 id="http-请求"><a href="#http-请求" class="headerlink" title="http 请求"></a>http 请求</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: 127.0.0.1:1337</span><br><span class="line">&gt; User-Agent: curl/7.49.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>报文第一个 <code>GET / HTTP/1.1</code> 被解析后分为如下属性：</p>
<ul>
<li><code>req.method</code> 请求方法，这里值为 GET，常见的有 GET POST DELETE PUT CONNECT 等</li>
<li><code>req.url</code> 请求路径，值为 /</li>
<li><code>req.httpVersion</code> http 协议版本，值为 1.1</li>
</ul>
<p>其余报头是规律的 key:value 形式，被解析后放在 <code>req.headers</code> 中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">headers:</span><br><span class="line">&#123; <span class="attr">host</span>: <span class="string">'127.0.0.1:1337'</span>,</span><br><span class="line">  <span class="string">'user-agent'</span>: <span class="string">'curl/7.49.1'</span>,</span><br><span class="line">  accept: <span class="string">'*/*'</span> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="http-响应"><a href="#http-响应" class="headerlink" title="http 响应"></a>http 响应</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 服务器完成处理向客户端返回响应报文</span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Content-Type: text/plain</span><br><span class="line">&lt; Date: Mon, 25 Jun 2018 04:26:49 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Transfer-Encoding: chunked</span><br><span class="line">&lt;</span><br></pre></td></tr></table></figure>
<p>同理报文头第一个被客户端解析为 <code>res.httpVersion</code> <code>res.statusCode</code> <code>res.statusMessage</code>, 其余报头会变为解析放在 <code>res.headers</code></p>
<ul>
<li><strong><code>res.statusCode</code> 获取或设置状态代码</strong></li>
<li><strong><code>res.statusMessage</code> 获取或设置状态描述信息</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">res.statusCode = <span class="number">200</span></span><br><span class="line">res.statusMessage = <span class="string">'ok'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// res.writeHeader 还可以设置响应头部，并且当响应头部发送出去后，res.statusCode/res.statusMessage 会被设置为已经发送出去的 状态代码/状态描述信息</span></span><br><span class="line">res.writeHeader(<span class="number">200</span>, <span class="string">'ok'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>res.setHeader</code> 可以多次设置响应报头</strong></li>
<li><strong><code>res.writeHeader</code> 只有调用该方法，报头才会写入到连接中</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// res.writeHeader 不但是设置头部，并且当 res.setHeader 设置了 header，res.writeHeader 设置同名 header 会覆盖之前的设置；并且 res.writeHeader 被调用后报头才会写入到连接中</span></span><br><span class="line">res.writeHeader(<span class="number">200</span>, <span class="string">'ok'</span>, &#123;</span><br><span class="line">	<span class="string">'Content-Type'</span>, <span class="string">'text/html'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>res.removeHeader(key)</code> 删除 某 header</strong></li>
<li><strong><code>res.getHeader(key)</code> 获取 某 header，这里 key 是小写</strong></li>
</ul>
<p>报文体部分</p>
<ul>
<li><strong><code>res.write()</code> 发送数据</strong></li>
<li><strong><code>res.end()</code> 先调用 write() 发送数据，再发送信号告知服务器这次响应结束</strong></li>
</ul>
<p><strong>报头是在报文体发送前发送的</strong>，一旦开始数据的发送， <code>setHeader</code> <code>writeHeader</code> 将不再生效</p>
<h4 id="http-客户端"><a href="#http-客户端" class="headerlink" title="http 客户端"></a>http 客户端</h4><ul>
<li><strong><code>http.request(options)</code> 构造 http 客户端</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http =</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Node-js/" rel="tag"># Node.js</a>
          
            <a href="/tags/Node-js-知识点梳理/" rel="tag"># Node.js 知识点梳理</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/19/Node.js 函数promise化/" rel="next" title="Node.js 函数promise化">
                <i class="fa fa-chevron-left"></i> Node.js 函数promise化
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/19/Node.js 创建一个静态资源服务器/" rel="prev" title="Node.js 创建一个静态资源服务器">
                Node.js 创建一个静态资源服务器 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars0.githubusercontent.com/u/8380737?s=460&v=4"
                alt="jhgrrewq" />
            
              <p class="site-author-name" itemprop="name">jhgrrewq</p>
              <p class="site-description motion-element" itemprop="description">爱好电影，更爱女神阿佳妮；爱网球，更爱罗杰费德勒。网易云音乐深度用户</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">117</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">81</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/jhgrrewq" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念和原理"><span class="nav-number">1.</span> <span class="nav-text">概念和原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#特点"><span class="nav-number">1.1.</span> <span class="nav-text">特点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#单线程"><span class="nav-number">1.1.1.</span> <span class="nav-text">单线程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#非阻塞-I-O"><span class="nav-number">1.1.2.</span> <span class="nav-text">非阻塞 I/O</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#事件驱动"><span class="nav-number">1.1.3.</span> <span class="nav-text">事件驱动</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#适合开发"><span class="nav-number">1.2.</span> <span class="nav-text">适合开发</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-js-内置模块"><span class="nav-number">2.</span> <span class="nav-text">Node.js 内置模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#fs"><span class="nav-number">2.1.</span> <span class="nav-text">fs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#文件读取"><span class="nav-number">2.1.1.</span> <span class="nav-text">文件读取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件写入"><span class="nav-number">2.1.2.</span> <span class="nav-text">文件写入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件流读取文件"><span class="nav-number">2.1.3.</span> <span class="nav-text">文件流读取文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件流写入文件"><span class="nav-number">2.1.4.</span> <span class="nav-text">文件流写入文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除文件"><span class="nav-number">2.1.5.</span> <span class="nav-text">删除文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件是否存在"><span class="nav-number">2.1.6.</span> <span class="nav-text">文件是否存在</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件重命名"><span class="nav-number">2.1.7.</span> <span class="nav-text">文件重命名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建目录"><span class="nav-number">2.1.8.</span> <span class="nav-text">创建目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#读取目录"><span class="nav-number">2.1.9.</span> <span class="nav-text">读取目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#监听文件修改"><span class="nav-number">2.1.10.</span> <span class="nav-text">监听文件修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改文件权限"><span class="nav-number">2.1.11.</span> <span class="nav-text">修改文件权限</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取文件状态"><span class="nav-number">2.1.12.</span> <span class="nav-text">获取文件状态</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#url-模块"><span class="nav-number">2.2.</span> <span class="nav-text">url 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#url-解析"><span class="nav-number">2.2.1.</span> <span class="nav-text">url 解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#urlObject"><span class="nav-number">2.2.2.</span> <span class="nav-text">urlObject</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#events-模块"><span class="nav-number">2.3.</span> <span class="nav-text">events 模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#path-模块"><span class="nav-number">2.4.</span> <span class="nav-text">path 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#获取路径-文件名-扩展名"><span class="nav-number">2.4.1.</span> <span class="nav-text">获取路径/文件名/扩展名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#格式化路径字符串"><span class="nav-number">2.4.2.</span> <span class="nav-text">格式化路径字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#路径组合"><span class="nav-number">2.4.3.</span> <span class="nav-text">路径组合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#路径解析"><span class="nav-number">2.4.4.</span> <span class="nav-text">路径解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取相对路径"><span class="nav-number">2.4.5.</span> <span class="nav-text">获取相对路径</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#平台相关"><span class="nav-number">2.4.6.</span> <span class="nav-text">平台相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#util-模块"><span class="nav-number">2.4.7.</span> <span class="nav-text">util 模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Buffer-模块"><span class="nav-number">2.5.</span> <span class="nav-text">Buffer 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Buffer-静态方法"><span class="nav-number">2.5.1.</span> <span class="nav-text">Buffer 静态方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Buffer-实例方法"><span class="nav-number">2.5.2.</span> <span class="nav-text">Buffer 实例方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zlib-模块"><span class="nav-number">2.6.</span> <span class="nav-text">zlib 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#压缩解压"><span class="nav-number">2.6.1.</span> <span class="nav-text">压缩解压</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string-decoder-模块"><span class="nav-number">2.7.</span> <span class="nav-text">string_decoder 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本用法"><span class="nav-number">2.7.1.</span> <span class="nav-text">基本用法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#process-模块"><span class="nav-number">2.8.</span> <span class="nav-text">process 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#环境变量"><span class="nav-number">2.8.1.</span> <span class="nav-text">环境变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#异步"><span class="nav-number">2.8.2.</span> <span class="nav-text">异步</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取命令行参数"><span class="nav-number">2.8.3.</span> <span class="nav-text">获取命令行参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#当前工作路径"><span class="nav-number">2.8.4.</span> <span class="nav-text">当前工作路径</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#child-process-模块"><span class="nav-number">2.9.</span> <span class="nav-text">child_process 模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#异步创建子进程（每个方法都有对应同步版本）"><span class="nav-number">2.10.</span> <span class="nav-text">异步创建子进程（每个方法都有对应同步版本）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#net-模块（TCP）"><span class="nav-number">2.11.</span> <span class="nav-text">net 模块（TCP）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#tcp-服务器事件"><span class="nav-number">2.11.1.</span> <span class="nav-text">tcp 服务器事件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#连接事件"><span class="nav-number">2.11.2.</span> <span class="nav-text">连接事件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dgram-模块（UDP）"><span class="nav-number">2.12.</span> <span class="nav-text">dgram 模块（UDP）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#http-模块"><span class="nav-number">2.13.</span> <span class="nav-text">http 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#http-请求"><span class="nav-number">2.13.1.</span> <span class="nav-text">http 请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http-响应"><span class="nav-number">2.13.2.</span> <span class="nav-text">http 响应</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http-客户端"><span class="nav-number">2.13.3.</span> <span class="nav-text">http 客户端</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jhgrrewq</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




<div>备案号 <a class="theme-link" target="_blank" href="http://www.beian.miit.gov.cn">浙ICP备18011306号-1</a></div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  

  

  


</body>
</html>
