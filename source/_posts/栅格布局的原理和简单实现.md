---
title: 栅格布局的原理和简单实现
tag: 
	- 栅格布局
    - less
---

>栅格系统的实现，通常是将**容器（container）均分为12等分**（12列可以被1、2、3、4、6等分，有更大灵活性，因此通常划分为12等分），再通过一系列行（row）和列（column）的组合创建页面布局，并调整**内外边距**， 结合**css的媒体查询**可以实现一个响应式的栅格布局
<!-- more -->

## 实现

html

```html
<!-- 栅格系统 -->
<div class="container">
    <div class="row">
    <div class="col-xs-4 col-sm-3">
        <span>test</span>
    </div>
    <div class="col-xs-8 col-sm-3">
        <span>test</span>
    </div>
    <div class="col-xs-4 col-sm-3">
        <span>test</span>
    </div>
    <!-- 循环栅格列 -->
    </div>
</div>
```

less 生成不同栅格

```less
@padding: 15px;                     // 栅格列内边距， 行外边距宽度
@colNum: 12;                        // 默认栅格列数

// 清理浮动
.clearfix(){
  content: '';
  display: table;
  clear: both;
}

// 定义栅格列
.col(@i) {
  float: left;                     // 浮动
  width: (@i * 100% / @colNum);    // 列宽
  position: relative;              // 相对定位
  min-height: 1px;                 // 最小高度
  padding-right: @padding;         // 内边距
  padding-left: @padding;          // 外边距
  box-sizing: border-box;          // 将内边距纳入到宽度计算中
}

.generate-col(@colNum);            
.generate-col(@n: @colNum, @i: 1) when(@i <= @n) {
    .col-xs-@{i} {                 // 不同比例的列
      .col(@i);
    }
    // 递归调用自身循环生成
    .generate-col(@n, (@i + 1));
};

@media (min-width: 414px) {       // 宽度大于 414px 的设备
  .generate-col(@colNum);
  .generate-col(@n: @colNum, @i: 1) when(@i <= @n) {
    .col-sm-@{i} {                // 特定设备下不同比例的列
      .col(@i);
    }
    // 递归调用自身循环生成
    .generate-col(@n, (@i + 1));
  };
}

.container{
    margin-left: auto;            // 居中
    margin-right: auto;           // 居中
    padding-left: @padding;       // 内边距
    padding-right: @padding;      // 外边距
    &::after{
        .clearfix();              // 清理浮动
    }
    .row{
        margin-right: -@padding;  // 负值外边距
        margin-left: -@padding;   // 负值外边距
        &::after{
            .clearfix();          // 清理浮动
        }
    }
}

```

## 原理

栅格系统有容器（container）、行（row）和列（column）组成，行包含在容器中，**只有列可以作为行的直接子元素**。如上列设置15px的内边距，建立了列之间的间距（gutter）。而**行设置了-15px的外边距从而抵消了容器的内边距，从而使整行可以占满容器。这个设定使得当采用多层嵌套的栅格布局时，行可以包裹在另一列中，可以抵消列的内边距**。

**上述 less 代码中行被分为12个栅格列，并预设了前缀为".col-xs-"的12个能包含不同数量列的类， 当行中元素包含列的个数查过12个，多余的列所在的元素会另起一行排列。**
结合css媒体查询，在宽度大于414像素的设备上预设了前缀为“.col-sm-”的12类，在html元素的class属性增加了"col-sm-3"样式类，因此在宽度414像素的设备上，可排列4个"col-sm-3"元素，而在宽度小于414像素的设备上，可排列3个"col-xs-4"元素。